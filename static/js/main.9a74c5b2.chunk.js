(this.webpackJsonparknights_app=this.webpackJsonparknights_app||[]).push([[0],{46:function(e,t,a){e.exports=a(94)},51:function(e,t,a){},52:function(e,t,a){},53:function(e,t,a){},54:function(e,t,a){},55:function(e,t,a){},56:function(e,t,a){},57:function(e,t,a){},90:function(e,t){},94:function(e,t,a){"use strict";a.r(t);var n=a(0),s=a.n(n),r=a(42),c=a.n(r),i=(a(51),a(44)),l=a(5),d=[{name:"\u514b\u6d1b\u4e1d",cost:1,atk:3,hp:1,mine:1,block:0,illust:"http://ak.mooncell.wiki/images/b/ba/%E7%AB%8B%E7%BB%98_%E5%85%8B%E6%B4%9B%E4%B8%9D_1.png"},{name:"\u963f\u7c73\u5a05",cost:3,atk:4,hp:2,mine:2,block:0,illust:"http://ak.mooncell.wiki/images/d/dd/%E7%AB%8B%E7%BB%98_%E9%98%BF%E7%B1%B3%E5%A8%85_1.png",desc:"\u91c7\u6398: \u83b7\u5f971\u5206"},{name:"\u73ab\u5170\u838e",cost:2,atk:2,hp:3,mine:1,block:1,illust:"http://ak.mooncell.wiki/images/0/09/%E7%AB%8B%E7%BB%98_%E7%8E%AB%E5%85%B0%E8%8E%8E_1.png"},{name:"\u7c73\u683c\u9c81",cost:2,atk:0,hp:5,mine:1,block:2,illust:"http://ak.mooncell.wiki/images/4/44/%E7%AB%8B%E7%BB%98_%E7%B1%B3%E6%A0%BC%E9%B2%81_1.png"},{name:"\u53f2\u90fd\u534e\u5fb7",cost:2,atk:2,hp:2,mine:2,block:0,illust:"http://ak.mooncell.wiki/images/4/44/%E7%AB%8B%E7%BB%98_%E5%8F%B2%E9%83%BD%E5%8D%8E%E5%BE%B7_1.png"},{name:"12F",cost:6,atk:6,hp:4,mine:5,block:0,illust:"http://ak.mooncell.wiki/images/6/61/%E7%AB%8B%E7%BB%98_12F_1.png"},{name:"\u9ed1\u89d2",cost:8,atk:8,hp:8,mine:4,block:2,illust:"http://ak.mooncell.wiki/images/d/dc/%E7%AB%8B%E7%BB%98_%E9%BB%91%E8%A7%92_1.png"},{name:"\u5de1\u6797\u8005",cost:5,atk:8,hp:4,mine:3,block:0,illust:"http://ak.mooncell.wiki/images/c/c8/%E7%AB%8B%E7%BB%98_%E5%B7%A1%E6%9E%97%E8%80%85_1.png"}],o=[{name:"\u5c0f\u5175",atk:2,hp:3,illust:"http://ak.mooncell.wiki/images/3/34/%E5%A4%B4%E5%83%8F_%E6%95%8C%E4%BA%BA_%E5%A3%AB%E5%85%B5.png"},{name:"\u730e\u72ac",atk:2,hp:2,illust:"http://ak.mooncell.wiki/images/3/3f/%E5%A4%B4%E5%83%8F_%E6%95%8C%E4%BA%BA_%E7%8C%8E%E7%8B%97.png"},{name:"\u6e90\u77f3\u866b",atk:1,hp:1,illust:"http://ak.mooncell.wiki/images/3/3e/%E5%A4%B4%E5%83%8F_%E6%95%8C%E4%BA%BA_%E6%BA%90%E7%9F%B3%E8%99%AB.png"},{name:"\u91cd\u88c5",atk:4,hp:6,illust:"http://ak.mooncell.wiki/images/f/f0/%E5%A4%B4%E5%83%8F_%E6%95%8C%E4%BA%BA_%E9%87%8D%E8%A3%85%E9%98%B2%E5%BE%A1%E8%80%85.png"},{name:"\u7834\u9635\u8005",atk:3,hp:2,illust:"http://ak.mooncell.wiki/images/f/f2/%E5%A4%B4%E5%83%8F_%E6%95%8C%E4%BA%BA_%E7%A0%B4%E9%98%B5%E8%80%85.png"}],u={alcohol:s.a.createElement("img",{src:"http://ak.mooncell.wiki/images/a/a8/%E9%81%93%E5%85%B7_%E5%B8%A6%E6%A1%86_%E6%89%AD%E8%BD%AC%E9%86%87.png",height:"25em"}),rma:s.a.createElement("img",{src:"http://ak.mooncell.wiki/images/7/7c/%E9%81%93%E5%85%B7_%E5%B8%A6%E6%A1%86_RMA70-12.png",height:"25em"}),rock:s.a.createElement("img",{src:"http://ak.mooncell.wiki/images/e/e7/%E9%81%93%E5%85%B7_%E5%B8%A6%E6%A1%86_%E7%A0%94%E7%A3%A8%E7%9F%B3.png",height:"25em"}),d32:s.a.createElement("img",{src:"http://ak.mooncell.wiki/images/7/76/%E9%81%93%E5%85%B7_%E5%B8%A6%E6%A1%86_D32%E9%92%A2.png",height:"25em"}),mine:s.a.createElement("img",{src:"https://dss1.bdstatic.com/6OF1bjeh1BF3odCf/it/u=1672017263,313384077&fm=74&app=80&f=JPEG&size=f121,121?sec=1880279984&t=807e81fe43f1078031ace9ef194ff68a",height:"20em"}),block:s.a.createElement("img",{src:"http://img5.imgtn.bdimg.com/it/u=1153648212,1889048357&fm=26&gp=0.jpg",height:"20em"})},h="https://ak.hypergryph.com/assets/index/images/ak/common/story/item_mortal_city.png",m=[u.alcohol,u.rma,u.rock,u.d32],_=[{requirements:[3,0,0,0],score:3,reward:1,desc:s.a.createElement("span",null,m[2]," \u2192 ? + ?"),effect:function(e,t){k(e,t,[0,0,1,0])&&g(e,t,2)}},{requirements:[0,3,0,0],score:3,reward:2,desc:s.a.createElement("span",null,m[0]," \u2192 ? + ?"),effect:function(e,t){k(e,t,[1,0,0,0])&&g(e,t,2)}},{requirements:[0,0,3,0],score:3,reward:0,desc:s.a.createElement("span",null,m[1]," \u2192 ? + ?"),effect:function(e,t){k(e,t,[0,1,0,0])&&g(e,t,2)}},{requirements:[3,0,0,0],score:3,reward:2,desc:s.a.createElement("span",null,m[1]," \u2192 ",m[3]),effect:function(e,t){k(e,t,[0,1,0,0])&&(e.materials[3]+=1)}},{requirements:[0,3,0,0],score:3,reward:0,desc:s.a.createElement("span",null,m[2]," \u2192 ",m[3]),effect:function(e,t){k(e,t,[0,0,1,0])&&(e.materials[3]+=1)}},{requirements:[0,0,3,0],score:3,reward:1,desc:s.a.createElement("span",null,m[0]," \u2192 ",m[3]),effect:function(e,t){k(e,t,[1,0,0,0])&&(e.materials[3]+=1)}},{requirements:[3,0,0,0],score:3,reward:1,desc:s.a.createElement("span",null,m[2]," \u2192 2\u5206"),effect:function(e,t){k(e,t,[0,0,1,0])&&(e.score+=2)}},{requirements:[0,3,0,0],score:3,reward:2,desc:s.a.createElement("span",null,m[0]," \u2192 2\u5206"),effect:function(e,t){k(e,t,[1,0,0,0])&&(e.score+=2)}},{requirements:[0,0,3,0],score:3,reward:0,desc:s.a.createElement("span",null,m[1]," \u2192 2\u5206"),effect:function(e,t){k(e,t,[0,1,0,0])&&(e.score+=2)}},{requirements:[3,0,0,0],score:3,reward:2,desc:s.a.createElement("span",null,"\u6536\u5165: ",m[1]),onTurnBegin:function(e,t){e.materials[1]+=1}},{requirements:[0,3,0,0],score:3,reward:0,desc:s.a.createElement("span",null,"\u6536\u5165: ",m[2]),onTurnBegin:function(e,t){e.materials[2]+=1}},{requirements:[0,0,3,0],score:3,reward:1,desc:s.a.createElement("span",null,"\u6536\u5165: ",m[0]),onTurnBegin:function(e,t){e.materials[0]+=1}}];function f(e,t){var a={};for(var n in t)a[n]=e(t[n],n);return a}function p(e,t,a,n,s){var r=s||0,c=e[a].splice(r,1)[0];return e[n].push(c),c}function g(e,t,a){for(var n=a||1,s=[],r=0;r<n;r++){var c=t.random.Die(3)-1;e.materials[c]+=1,s.push(c)}e.gained=s}function k(e,t,a){for(var n=0,s=0;s<4;s++)e.materials[s]<a[s]&&(n+=a[s]-e.materials[s]);if(e.materials[3]<n)return w(e,t,"\u6750\u6599\u4e0d\u8db3"),!1;for(var r=0;r<4;r++)e.materials[r]-=a[r],e.materials[r]<0&&(e.materials[3]+=e.materials[r],e.materials[r]=0);return e.gained=[],!0}function b(e,t,a){return!a.exhausted&&(a.exhausted=!0,!0)}function E(e,t,a,n,s){var r=e[a][n];(r.dmg=r.dmg||0,r.dmg+=s,w(e,t,"".concat(r.name," \u53d7\u5230").concat(s,"\u70b9\u4f24\u5bb3")),r.dmg>=r.hp)&&(p(e,0,a,"field"==a?"discard":"ediscard",n),w(e,t,"".concat(r.name," \u88ab\u6467\u6bc1")))}function v(e,t){e.deck.length>0&&p(e,0,"deck","hand")}function y(e,t){e.odeck.length>0&&p(e,0,"odeck","orders")}function B(e,t){if(e.edeck.length>0){var a=p(e,0,"edeck","efield");a.exhausted=!0,a.dmg=0,w(e,t,"".concat(a.name," \u5165\u573a")),a.onPlay&&a.onPlay(e,t,a)}}function w(e,t,a){e.messages.unshift(a)}var O={setup:function(e){var t={hand:[],field:[],deck:[]},a=function(){return o.map((function(e){return Object.assign({},e)}))};return t.edeck=e.random.Shuffle(a().concat(a())),t.odeck=e.random.Shuffle(_.map((function(e){return Object.assign({},e)}))),t.efield=[],t.discard=[],t.ediscard=[],t.orders=[],t.finished=[],t.costs=2,t.materials=[0,0,0,0],t.score=0,t.danger=0,t.goal=10,t.max_danger=8,t.exhausted_enter=!1,t.messages=["\u6b22\u8fce\u6765\u5230\u660e\u65e5\u65b9\u821f: \u91c7\u6398\u884c\u52a8"],t.playing=!1,t.gained=[],t},moves:{setDeck:function(e,t,a){var n,s=function(e){var t,a={},n=Object(l.a)(e);try{for(n.s();!(t=n.n()).done;){var s=t.value;a[s.name]=s}}catch(r){n.e(r)}finally{n.f()}return a}(d),r=[],c=a.split("\n"),i=Object(l.a)(c);try{for(i.s();!(n=i.n()).done;){var o=n.value.split(" ");if(o.length>=2){var u=parseInt(o[0])||0,h=s[o[1]];if(h)for(var m=0;m<u;m++)r.push(Object.assign({},h))}}}catch(_){i.e(_)}finally{i.f()}e.deck=t.random.Shuffle(r)},addTags:function(e,t,a){var n,s=Object(l.a)(a);try{for(s.s();!(n=s.n()).done;){n.value.effect(e,t)}}catch(r){s.e(r)}finally{s.f()}},onScenarioBegin:function(e,t){for(var a=0;a<4;a++)v(e);for(var n=0;n<2;n++)B(e,t);for(var s=0;s<3;s++)y(e);console.log("Setup finished"),e.playing=!0,t.events.endTurn()},draw:v,play:function(e,t,a){var n=e.hand[a];(function(e,t,a){return e.costs>=a?(e.costs-=a,!0):(w(e,t,"\u8d39\u7528\u4e0d\u8db3"),!1)})(e,t,n.cost)&&(p(e,0,"hand","field",a),n.dmg=0,n.exhausted=e.exhausted_enter,w(e,t,"\u90e8\u7f72 ".concat(n.name)),n.onPlay&&n.onPlay(e,t,n))},mine:function(e,t,a){var n=e.field[a];b(0,0,n)&&(g(e,t,n.mine),w(e,t,"\u4f7f\u7528 ".concat(n.name," \u91c7\u6398")))},setValue:function(e,t,a,n){e[a]=n},drawOrder:y,finishOrder:function(e,t,a){var n=e.orders[a];k(e,t,n.requirements)&&(e.materials[n.reward]+=1,e.score+=n.score,e.finished.push(e.orders.splice(a,1)[0]),w(e,t,"\u5b8c\u6210\u8ba2\u5355"))},useOrder:function(e,t,a){var n=e.finished[a];b(0,0,n)&&n.effect(e,t)},drawEnemy:B,fight:function(e,t,a,n){if(a<0||a>=e.field.length||n<0||n>=e.efield.length)console.log("invalid move");else{var s=e.field[a];e.efield[n];b(0,0,s)&&(w(e,t,"\u4f7f\u7528 ".concat(s.name," \u6218\u6597")),E(e,t,"efield",n,s.atk))}},enemyMove:function(e,t,a){var n=e.efield[a];if(b(0,0,n)){var s=function(e,t,a){var n,s=0,r=Object(l.a)(e.field);try{for(r.s();!(n=r.n()).done;){var c=n.value;if((s+=c.block||0)>a)return c}}catch(i){r.e(i)}finally{r.f()}return!1}(e,0,a),r=e.field.indexOf(s);s?(E(e,t,"field",r,n.atk),w(e,t,"".concat(n.name," \u5bf9 ").concat(s.name," \u53d1\u8d77\u4e86\u8fdb\u653b"))):(e.danger+=1,w(e,t,"".concat(n.name," \u53d1\u8d77\u4e86\u52a8\u4e71")))}},logMsg:w,changeMsg:function(e,t,a){e.messages[0]=a}},turn:{onBegin:function(e,t){e.playing&&(console.log("On turn begin"),w(e,0,"\u56de\u5408\u5f00\u59cb"),function(e,t){var a,n=Object(l.a)([].concat(e.field,e.efield,e.finished));try{for(n.s();!(a=n.n()).done;){a.value.exhausted=!1}}catch(s){n.e(s)}finally{n.f()}}(e),v(e),y(e),e.costs+=3)}},endIf:function(e,t){if(e.playing){if(0==e.deck.length)return{win:!1,reason:"\u724c\u5e93\u88ab\u62bd\u5149"};if(0==e.edeck.length)return{win:!1,reason:"\u654c\u4eba\u724c\u5e93\u88ab\u62bd\u5149"};if(e.danger>=e.max_danger)return{win:!1,reason:"\u52a8\u4e71\u6307\u6570\u8fc7\u9ad8"};if(e.score>=e.goal)return{win:!0}}}},j=a(4),A=a(6),x=a(1),S=a(8),C=a(7),G=(a(52),function(e){var t={illust:{},e_illust:{},o_illust:{},hp:{}};if(e.cardState.exhausted){t.illust.border="1px solid red",t.e_illust.border="1px solid red",t.o_illust.border="1px solid red"}if(e.cardState.selected)if(e.cardState.exhausted){t.illust.border="3px solid purple",t.e_illust.border="3px solid purple",t.o_illust.border="3px solid purple"}else{t.illust.border="3px solid blue",t.e_illust.border="3px solid blue",t.o_illust.border="3px solid blue"}return e.cardState.damaged&&(t.hp.color="red"),s.a.createElement("div",{className:"card",onClick:e.handleClick},Object.keys(e.data).map((function(a){return s.a.createElement(N,{variant:a,value:e.data[a],additionalStyle:t[a]})})))}),N=function(e){var t=e.variant.includes("illust"),a=s.a.createElement("img",{className:e.variant,src:e.value});return s.a.createElement("div",{className:"data "+e.variant,style:e.additionalStyle},t?a:e.value)},q=function(e){return s.a.createElement("div",{className:"card-row"},e.cards.map((function(t,a){return s.a.createElement(G,{data:t,cardState:e.states[a],handleClick:e.handleClick?e.handleClick(a):null})})))},T=function(e){return s.a.createElement("div",{className:"card-board",align:"center"},s.a.createElement("div",{className:"card-detailed"},Object.keys(e.card).map((function(t){return s.a.createElement(N,{variant:t,value:e.card[t]})}))),s.a.createElement("button",{className:"card-detailed-button",onClick:e.handleClick},"\u5b8c\u6210\u67e5\u770b"))},F=(a(53),function(e){return s.a.createElement("div",{className:"controller"},Object.keys(e.actions).map((function(t){return s.a.createElement("button",{onClick:e.actions[t],className:"controller-button"},t)})))}),D=function(e){return s.a.createElement("div",{className:"enter-game"},s.a.createElement("button",{className:"enter-game",onClick:e.switchScene},e.switchText),s.a.createElement("button",{className:"enter-game",onClick:e.enterGame},"\u8fdb\u5165\u6e38\u620f"))},M=(a(54),function(e){return s.a.createElement("div",{className:e.variant},e.content)}),P=(a(55),function(e){for(var t=[],a=0;a<e.tags.length;a+=3){var n,r=[],c=e.tags.slice(a,a+3),i=Object(l.a)(c);try{for(i.s();!(n=i.n()).done;){var d=n.value;r.push(s.a.createElement("td",{className:"tag",onClick:e.handleClick(e.tags.indexOf(d))},s.a.createElement("img",{className:"tag",src:d.src,style:{borderColor:d.selected?"red":"black"}})))}}catch(o){i.e(o)}finally{i.f()}t.push(s.a.createElement("tr",null,r))}return s.a.createElement("div",{className:"tag-selection"},s.a.createElement("table",null,s.a.createElement("tbody",null,t)))}),I=function(e){return s.a.createElement("div",{className:"tag-list"},s.a.createElement("ul",{style:{marginLeft:"-6%",marginTop:"1%"}},e.selected_tags.map((function(e){return s.a.createElement("li",{className:"tag-desc"},e.desc)}))))},J=function(e){return s.a.createElement("div",{className:"risk-level"},"\u5371\u673a\u7b49\u7ea7:",s.a.createElement("br",null),s.a.createElement("span",{className:"risk-level-value"},e.risk_level))},L=(a(56),function(e){return s.a.createElement("div",{className:"deck-construction"},s.a.createElement("form",null,s.a.createElement("textarea",{value:e.value,onChange:e.handleChange,className:"deck-construction",rows:25,columns:20})))});var z=function(e){var t,a=[],n=Object(l.a)(e);try{for(n.s();!(t=n.n()).done;){var s=t.value;if(s.selected=!1,1==s.level)for(var r=0;r<3;r++)a.push(Object.assign({},s));else a.push(Object.assign({},s))}}catch(c){n.e(c)}finally{n.f()}return a}([{src:"http://ak.mooncell.wiki/images/d/d3/Enemy_def_1.png",desc:"\u80dc\u5229\u6240\u9700\u7684\u5206\u6570+2",level:1,effect:function(e,t){e.goal+=2}},{src:"http://ak.mooncell.wiki/images/a/a6/Global_lifepoint_1.png",desc:"\u6211\u65b9\u53ef\u627f\u53d7\u7684\u52a8\u4e71\u6307\u6570-2",level:1,effect:function(e,t){e.max_danger-=2}},{src:"http://ak.mooncell.wiki/images/5/5a/Enemy_atk_1.png",desc:"\u6240\u6709\u654c\u4eba\u83b7\u5f97+2\u653b\u51fb\u529b",level:1,effect:function(e,t){var a,n=Object(l.a)(e.edeck);try{for(n.s();!(a=n.n()).done;){a.value.atk+=2}}catch(s){n.e(s)}finally{n.f()}}},{src:"http://ak.mooncell.wiki/images/4/4e/Enemy_hp_1.png",desc:"\u6240\u6709\u654c\u4eba\u83b7\u5f97+2\u751f\u547d\u503c",level:1,effect:function(e,t){var a,n=Object(l.a)(e.edeck);try{for(n.s();!(a=n.n()).done;){a.value.hp+=2}}catch(s){n.e(s)}finally{n.f()}}},{src:"http://ak.mooncell.wiki/images/f/f7/Enemy_movespeed_1.png",desc:"\u5e72\u5458\u4ee5\u6a2a\u7f6e\u72b6\u6001\u5165\u573a",level:2,effect:function(e,t){e.exhausted_enter=!0}}]),R=(a(57),function(e){Object(S.a)(a,e);var t=Object(C.a)(a);function a(e){var n;return Object(j.a)(this,a),(n=t.call(this,e)).handle_hand_clicked=n.handle_hand_clicked.bind(Object(x.a)(n)),n.handle_field_clicked=n.handle_field_clicked.bind(Object(x.a)(n)),n.handle_efield_clicked=n.handle_efield_clicked.bind(Object(x.a)(n)),n.handle_order_clicked=n.handle_order_clicked.bind(Object(x.a)(n)),n.handle_finished_clicked=n.handle_finished_clicked.bind(Object(x.a)(n)),n.handle_deck_change=n.handle_deck_change.bind(Object(x.a)(n)),n.enemy_move=n.enemy_move.bind(Object(x.a)(n)),n.process_hand_data=n.process_hand_data.bind(Object(x.a)(n)),n.process_hand_state=n.process_hand_state.bind(Object(x.a)(n)),n.process_field_data=n.process_field_data.bind(Object(x.a)(n)),n.process_field_state=n.process_field_state.bind(Object(x.a)(n)),n.process_efield_data=n.process_efield_data.bind(Object(x.a)(n)),n.process_efield_state=n.process_efield_state.bind(Object(x.a)(n)),n.process_order_data=n.process_order_data.bind(Object(x.a)(n)),n.process_order_state=n.process_order_state.bind(Object(x.a)(n)),n.process_finished_data=n.process_finished_data.bind(Object(x.a)(n)),n.process_finished_state=n.process_finished_state.bind(Object(x.a)(n)),n.process_card_details=n.process_card_details.bind(Object(x.a)(n)),n.process_enemy_details=n.process_enemy_details.bind(Object(x.a)(n)),n.process_order_details=n.process_order_details.bind(Object(x.a)(n)),n.wrap_controller_action=n.wrap_controller_action.bind(Object(x.a)(n)),n.set_branch=n.set_branch.bind(Object(x.a)(n)),n.check_card=n.check_card.bind(Object(x.a)(n)),n.play_card=n.play_card.bind(Object(x.a)(n)),n.use_mine=n.use_mine.bind(Object(x.a)(n)),n.use_fight=n.use_fight.bind(Object(x.a)(n)),n.finish_order=n.finish_order.bind(Object(x.a)(n)),n.use_order=n.use_order.bind(Object(x.a)(n)),n.render_game_board=n.render_game_board.bind(Object(x.a)(n)),n.render_tag_board=n.render_tag_board.bind(Object(x.a)(n)),n.render_deck_board=n.render_deck_board.bind(Object(x.a)(n)),n.render_card_board=n.render_card_board.bind(Object(x.a)(n)),n.change_board=n.change_board.bind(Object(x.a)(n)),n.choose_tag=n.choose_tag.bind(Object(x.a)(n)),n.get_risk_level=n.get_risk_level.bind(Object(x.a)(n)),n.enter_game=n.enter_game.bind(Object(x.a)(n)),n.state={hand_selected:-1,field_selected:-1,efield_selected:-1,order_selected:-1,finished_selected:-1,branch:{},show_field:!0,show_tag_selection:!1,stage:"player",board:n.render_tag_board,tags:z,risk_level:0,deck_data:"2 \u514b\u6d1b\u4e1d\n2 \u73ab\u5170\u838e\n2 \u7c73\u683c\u9c81\n2 \u53f2\u90fd\u534e\u5fb7\n2 12F\n2 \u5de1\u6797\u8005\n2 \u9ed1\u89d2\n",checking:{},scenario_finished:!1},n.branches={hand:{"\u90e8\u7f72":n.play_card,"\u67e5\u770b":n.check_card},field:{"\u91c7\u6398":n.use_mine,"\u6218\u6597":n.use_fight,"\u67e5\u770b":n.check_card},efield:{"\u6218\u6597":n.use_fight,"\u67e5\u770b":n.check_card},orders:{"\u5b8c\u6210":n.finish_order,"\u67e5\u770b":n.check_card},finished:{"\u884c\u52a8":n.use_order,"\u67e5\u770b":n.check_card}},n.log_select=function(){return n.props.G.messages[0].includes("\u9009\u5b9a")?n.props.moves.changeMsg:n.props.moves.logMsg},n}return Object(A.a)(a,[{key:"choose_tag",value:function(e){var t=this;return function(){var a=t.state.tags;a[e].selected=!a[e].selected,t.setState({tags:a})}}},{key:"get_risk_level",value:function(){return this.state.tags.filter((function(e){return e.selected})).reduce((function(e,t){return e+t.level}),0)}},{key:"check_card",value:function(){return this.change_board("card"),this.state.branch}},{key:"play_card",value:function(){return this.props.moves.play(this.state.hand_selected),this.setState({hand_selected:-1}),{}}},{key:"use_mine",value:function(){return this.props.moves.mine(this.state.field_selected),this.setState({field_selected:-1}),{}}},{key:"use_fight",value:function(){return this.props.moves.fight(this.state.field_selected,this.state.efield_selected),this.setState({field_selected:-1,efield_selected:-1}),{}}},{key:"finish_order",value:function(){return this.props.moves.finishOrder(this.state.order_selected),this.setState({order_selected:-1}),{}}},{key:"use_order",value:function(){return this.props.moves.useOrder(this.state.finished_selected),this.setState({finished_selected:-1}),{}}},{key:"process_hand_data",value:function(e){return{illust:e.illust,atk:e.atk,hp:e.hp,cost:e.cost}}},{key:"process_hand_state",value:function(e){return{selected:this.state.hand_selected==this.props.G.hand.indexOf(e)}}},{key:"process_field_data",value:function(e){var t={illust:e.illust,atk:e.atk,hp:e.hp-e.dmg,mine:s.a.createElement("span",null,u.mine,e.mine)};return e.block>0&&(t.block=s.a.createElement("span",null,u.block,e.block)),t}},{key:"process_field_state",value:function(e){return{selected:this.state.field_selected==this.props.G.field.indexOf(e),exhausted:e.exhausted,damaged:e.dmg>0}}},{key:"process_efield_data",value:function(e){return{e_illust:e.illust,atk:e.atk,hp:e.hp-e.dmg}}},{key:"process_efield_state",value:function(e){return{selected:this.state.efield_selected==this.props.G.efield.indexOf(e),exhausted:e.exhausted,damaged:e.dmg>0}}},{key:"process_order_data",value:function(e){for(var t=[],a=0;a<3;a++)for(var n=u[Object.keys(u)[a]],s=e.requirements[a],r=0;r<s;r++)t.push(n);return{o_illust:h,requirements:t,score:e.score,reward:m[e.reward]}}},{key:"process_order_state",value:function(e){return{selected:this.state.order_selected==this.props.G.orders.indexOf(e),exhausted:e.exhausted}}},{key:"process_finished_data",value:function(e){return{o_illust:"https://ak.hypergryph.com/assets/index/images/ak/common/story/item_mortal_city.png",order_effect:e.desc}}},{key:"process_finished_state",value:function(e){return{selected:this.state.finished_selected==this.props.G.finished.indexOf(e),exhausted:e.exhausted}}},{key:"process_card_details",value:function(e){return{illust_detailed:e.illust,cost_detailed:e.cost,desc:s.a.createElement("span",null,e.atk,"/",e.hp," \xa0",u.mine,e.mine," \xa0",e.block>0?s.a.createElement("span",null,u.block,e.block):"",s.a.createElement("br",null),e.desc||"")}}},{key:"process_enemy_details",value:function(e){return{eo_illust_detailed:e.illust,desc:s.a.createElement("span",null,e.atk,"/",e.hp,s.a.createElement("br",null),e.desc||"")}}},{key:"process_order_details",value:function(e){return{eo_illust_detailed:h,desc:e.desc}}},{key:"enemy_move",value:function(e){var t,a=this;if(e<this.props.G.efield.length){this.setState({stage:"enemy"});var n=350;e<0?this.props.moves.drawEnemy():(this.props.G.efield[e].exhausted&&(n=50),this.props.moves.enemyMove(e)),(t=n,new Promise((function(e){return setTimeout(e,t)}))).then((function(){a.enemy_move(e+1)}))}else this.props.events.endTurn(),this.setState({stage:"player"})}},{key:"handle_hand_clicked",value:function(e){var t=this,a=this.props.G.hand[e];return function(){t.setState({hand_selected:e,checking:t.process_card_details(a)}),t.set_branch("hand"),t.log_select()("\u9009\u5b9a "+a.name)}}},{key:"handle_field_clicked",value:function(e){var t=this,a=this.props.G.field[e];return function(){t.setState({field_selected:e,checking:t.process_card_details(a)}),t.set_branch("field"),t.log_select()("\u9009\u5b9a "+a.name)}}},{key:"handle_efield_clicked",value:function(e){var t=this,a=this.props.G.efield[e];return function(){t.setState({efield_selected:e,checking:t.process_enemy_details(a)}),t.set_branch("efield"),t.log_select()("\u9009\u5b9a "+a.name)}}},{key:"handle_order_clicked",value:function(e){var t=this,a=this.props.G.orders[e];return function(){t.setState({order_selected:e,checking:t.process_order_details(a)}),t.set_branch("orders"),t.log_select()("\u9009\u5b9a\u8ba2\u5355")}}},{key:"handle_finished_clicked",value:function(e){var t=this,a=this.props.G.finished[e];return function(){t.setState({finished_selected:e,checking:t.process_order_details(a)}),t.set_branch("finished"),t.log_select()("\u9009\u5b9a\u8ba2\u5355")}}},{key:"handle_deck_change",value:function(e){this.setState({deck_data:e.target.value})}},{key:"wrap_controller_action",value:function(e){var t=this;return function(){t.set_branch(e())}}},{key:"set_branch",value:function(e){"string"==typeof e?this.setState({branch:f(this.wrap_controller_action,this.branches[e])}):this.setState({branch:f(this.wrap_controller_action,e)})}},{key:"change_board",value:function(e){var t={game:this.render_game_board,tag:this.render_tag_board,deck:this.render_deck_board,card:this.render_card_board};this.setState({board:t[e]})}},{key:"enter_game",value:function(){this.props.moves.setDeck(this.state.deck_data),this.props.moves.addTags(this.state.tags.filter((function(e){return e.selected}))),this.props.moves.onScenarioBegin(),this.change_board("game")}},{key:"end_game",value:function(){this.props.reset(),this.setState({scenario_finished:!1}),this.change_board("tag")}},{key:"componentDidUpdate",value:function(){var e=this.props.ctx.gameover;if(e&&!this.state.scenario_finished)if(this.setState({scenario_finished:!0}),e.win){var t=this.get_risk_level(),a="D";a=t>=0&&t<2?"C":t>=2&&t<4?"B":t>=4&&t<6?"A":t>=6&&t<8?"S":t>=8&&t<10?"SS":"SSS",alert("\u4efb\u52a1\u5b8c\u6210\n\u5b8c\u6210\u5371\u673a\u7b49\u7ea7: ".concat(t,"\n\u8bc4\u7ea7: ").concat(a))}else alert("\u4efb\u52a1\u5931\u8d25\n\u539f\u56e0: ".concat(e.reason))}},{key:"render_game_board",value:function(){var e=this,t=s.a.createElement("div",null,s.a.createElement("p",{style:{marginTop:"2%"}},[0,1,2,3].map((function(t){return s.a.createElement("span",{style:{color:e.props.G.gained.includes(t)?"blue":"black"}},m[t],":",e.props.G.materials[t],"\xa0\xa0\xa0")})),"\u8d39\u7528: ",this.props.G.costs,s.a.createElement("br",null),s.a.createElement("button",{className:"player-panel-button",onClick:function(){e.setState({show_field:!e.state.show_field})}},this.state.show_field?"\u67e5\u770b\u8ba2\u5355":"\u67e5\u770b\u6218\u573a"),s.a.createElement("button",{className:"player-panel-button",style:{display:"enemy"==this.state.stage?"none":""},onClick:function(){e.enemy_move(-2)}},"\u7ed3\u675f\u56de\u5408"),s.a.createElement("button",{className:"player-panel-button",style:{display:this.props.ctx.gameover?"":"none"},onClick:function(){e.end_game()}},"\u7ed3\u675f\u6e38\u620f"))),a=s.a.createElement("div",null,s.a.createElement("p",{style:{marginTop:"0%"}},"\u52a8\u4e71:",this.props.G.danger,"/",this.props.G.max_danger," \xa0\xa0\xa0 \u5206\u6570:",this.props.G.score,"/",this.props.G.goal,s.a.createElement("br",null),s.a.createElement("span",{onClick:function(){alert(e.props.G.messages.slice(0,20).join("\n"))}},this.props.G.messages[0]))),n=s.a.createElement(q,{cards:this.props.G.field.map(this.process_field_data),states:this.props.G.field.map(this.process_field_state),handleClick:this.handle_field_clicked}),r=s.a.createElement(q,{cards:this.props.G.hand.map(this.process_hand_data),states:this.props.G.hand.map(this.process_hand_state),handleClick:this.handle_hand_clicked}),c=s.a.createElement(q,{cards:this.props.G.orders.map(this.process_order_data),states:this.props.G.orders.map(this.process_order_state),handleClick:this.handle_order_clicked}),i=s.a.createElement(q,{cards:this.props.G.finished.map(this.process_finished_data),states:this.props.G.finished.map(this.process_finished_state),handleClick:this.handle_finished_clicked});return s.a.createElement("div",{className:"board"},s.a.createElement(M,{variant:"game-panel",content:a}),s.a.createElement(q,{cards:this.props.G.efield.map(this.process_efield_data),states:this.props.G.efield.map(this.process_efield_state),handleClick:this.handle_efield_clicked}),this.state.show_field?n:i,s.a.createElement(F,{actions:this.state.branch}),this.state.show_field?r:c,s.a.createElement(M,{variant:"player-panel",content:t}))}},{key:"render_card_board",value:function(){var e=this;return s.a.createElement("div",{className:"board",align:"center"},s.a.createElement(T,{card:this.state.checking,handleClick:function(){return e.change_board("game")}}))}},{key:"render_tag_board",value:function(){var e=this,t=this.get_risk_level();return s.a.createElement("div",{className:"board"},s.a.createElement(P,{tags:this.state.tags,handleClick:this.choose_tag}),s.a.createElement(I,{selected_tags:this.state.tags.filter((function(e){return e.selected}))}),s.a.createElement(J,{risk_level:t}),s.a.createElement("br",null),s.a.createElement("div",{style:{color:"red",marginLeft:"2%",marginTop:"-3%",display:t>=5?"":"none"}},"\u5f53\u524d\u5408\u7ea6\u96be\u5ea6\u6781\u5927\uff0c\u8bf7\u8c28\u614e\u884c\u52a8"),s.a.createElement(D,{switchScene:function(){e.change_board("deck")},switchText:"\u67e5\u770b\u5361\u7ec4",enterGame:function(){e.enter_game()}}))}},{key:"render_deck_board",value:function(){var e=this;return s.a.createElement("div",{className:"board"},s.a.createElement(L,{value:this.state.deck_data,handleChange:this.handle_deck_change}),s.a.createElement(D,{switchScene:function(){e.change_board("tag")},switchText:"\u67e5\u770b\u8bcd\u6761",enterGame:function(){e.enter_game()}}))}},{key:"render",value:function(){return this.state.board()}}]),a}(s.a.Component)),U=Object(i.a)({game:O,board:R,debug:!1});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(s.a.createElement(U,null),document.getElementById("root"))}},[[46,1,2]]]);
//# sourceMappingURL=main.9a74c5b2.chunk.js.map